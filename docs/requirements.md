# 激光通信上位机 - 项目需求与功能列表

## 1. 项目概述

本项目为基于 SNSPD 激光通信应用验证的收发处理系统上位机软件。上位机通过网口与下位机（FPGA）通信，实现参数配置、数据传输、状态监控等功能。

---

## 2. 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                        上位机                                │
│  ┌─────────────────┐              ┌─────────────────┐       │
│  │     发送端      │              │     接收端      │       │
│  │  - 数据源选择   │              │  - 图像显示     │       │
│  │  - 图像预览     │              │  - 统计数据显示 │       │
│  │  - 参数控制     │              │  - 参数控制     │       │
│  └────────┬────────┘              └────────┬────────┘       │
│           │                                │                │
│           └────────────┬───────────────────┘                │
│                        │                                    │
│                   网口通信                                   │
└────────────────────────┼────────────────────────────────────┘
                         │
                    ┌────┴────┐
                    │  下位机  │
                    │ (FPGA)  │
                    └─────────┘
```

---

## 3. 通信协议

### 3.1 发送帧格式

| 帧类型     | 字段       | 说明                             |
| ---------- | ---------- | -------------------------------- |
| **控制帧** | 调制方式   | RZ-OOK / PPM                     |
|            | 编译码方式 | RS(255,223) / LDPC(8176,7154) 等 |
|            | 速率模式   | 高速/低速档位                    |
| **数据帧** | 视频流数据 | 编码后的图像/视频数据            |

### 3.2 接收帧格式

| 帧类型     | 字段       | 说明                  |
| ---------- | ---------- | --------------------- |
| **统计帧** | 误码率     | 实时误码率            |
|            | 信息速率   | 当前通信速率          |
|            | 调制方式   | 当前调制方式          |
|            | 编译码方式 | 当前编译码方式        |
| **数据帧** | 视频流数据 | 接收到的图像/视频数据 |

---

## 4. 功能列表

### 4.1 发送端功能

| 序号 | 功能模块   | 功能项         | 描述                            |
| ---- | ---------- | -------------- | ------------------------------- |
| 1.1  | 数据源选择 | 摄像头采集     | 选择本地摄像头实时采集视频流    |
| 1.2  |            | 视频文件读取   | 选择本地视频文件进行播放发送    |
| 1.3  |            | 图像文件读取   | 选择本地图像文件进行发送        |
| 2.1  | 图像预览   | 发送画面显示   | 实时显示即将发送/正在发送的画面 |
| 3.1  | 参数控制   | 调制方式设置   | 设置 RZ-OOK / PPM 调制方式      |
| 3.2  |            | 编译码方式设置 | 选择 RS / LDPC 编译码方式       |
| 3.3  |            | 速率模式设置   | 设置通信速率档位                |
| 3.4  |            | 发送控制帧     | 将参数配置下发至下位机          |
| 4.1  | 传输控制   | 开始发送       | 开始向下位机发送数据帧          |
| 4.2  |            | 停止发送       | 停止发送数据帧                  |

### 4.2 接收端功能

| 序号 | 功能模块     | 功能项         | 描述                        |
| ---- | ------------ | -------------- | --------------------------- |
| 5.1  | 图像显示     | 接收画面显示   | 实时显示接收到的图像/视频流 |
| 6.1  | 统计数据显示 | 误码率显示     | 实时显示当前误码率          |
| 6.2  |              | 信息速率显示   | 实时显示当前通信速率        |
| 6.3  |              | 调制方式显示   | 显示当前调制方式            |
| 6.4  |              | 编译码方式显示 | 显示当前编译码方式          |
| 7.1  | 参数控制     | 调制方式设置   | 设置接收端调制方式          |
| 7.2  |              | 编译码方式设置 | 设置接收端编译码方式        |
| 7.3  |              | 速率模式设置   | 设置接收端速率模式          |
| 7.4  |              | 发送控制帧     | 将参数配置下发至下位机      |
| 8.1  | 传输控制     | 开始接收       | 开始接收下位机数据          |
| 8.2  |              | 停止接收       | 停止接收数据                |

### 4.3 通用功能

| 序号 | 功能模块 | 功能项       | 描述                   |
| ---- | -------- | ------------ | ---------------------- |
| 9.1  | 模式选择 | 仅发送模式   | 只启用发送端功能       |
| 9.2  |          | 仅接收模式   | 只启用接收端功能       |
| 9.3  |          | 收发模式     | 同时启用发送端和接收端 |
| 10.1 | 网络配置 | 下位机IP配置 | 配置下位机网络地址     |
| 10.2 |          | 端口配置     | 配置通信端口           |
| 10.3 |          | 连接状态显示 | 显示与下位机的连接状态 |
| 11.1 | 数据存储 | 接收数据保存 | 保存接收到的图像/视频  |
| 11.2 |          | 统计数据导出 | 导出统计数据记录       |

---

## 5. 参数配置项

### 5.1 调制方式

| 选项   | 说明                |
| ------ | ------------------- |
| RZ-OOK | 脉冲宽度不小于250ps |
| PPM    | 脉冲宽度不小于200ps |

### 5.2 编译码方式

| 选项            | 说明              |
| --------------- | ----------------- |
| RS(255,223)     | Reed-Solomon 编码 |
| LDPC(8176,7154) | 低密度奇偶校验码  |

### 5.3 速率模式

| 模式 | 上行时隙速率 | 下行时隙速率 |
| ---- | ------------ | ------------ |
| 高速 | 311MHz       | 5GHz         |
| 低速 | 10MHz        | 10MHz        |

---

## 6. 非功能性需求

| 类别   | 需求                         |
| ------ | ---------------------------- |
| 性能   | 视频流至少满足1080P实时传输  |
| 实时性 | 统计数据实时刷新显示         |
| 可靠性 | 网络断开后自动重连           |
| 易用性 | 参数可保存，下次启动自动加载 |
